@import andxor.syntax._

@(tpesList: List[List[String]])

import scalaz.{Monoid, Need}

package object tuple {
  @tpesList.map { tpes =>
    implicit def tuple@{tpes.length}Monoid[@{tpes.prod}](implicit @{tpes.paramSig("Monoid", "m")}): Monoid[(@{tpes.prod})] =
      new Monoid[(@{tpes.prod})] {
        type T = (@{tpes.prod})
        def zero: T = (@{tpes.paramList("m").map(m => s"$m.zero").mkString(", ")})
        def append(t1: T, _t2: => T): T = {
          val t2 = Need(_t2)
          (@{tpes.paramList("m").zipWithIndex.map(t => s"${t._1}.append(t1._${t._2 + 1}, t2.value._${t._2 + 1})").mkString(", ")})
        }
      }
  }
}
